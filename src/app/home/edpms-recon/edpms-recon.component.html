<div class="content-wrap ml-0 scroll-bar-main">
    <main id="content" class="content table-padding" role="main">
        <div class="header-panel-upload">
            <h3 class="heading">New EDPMS Data</h3>
        </div>
        <div class="upload-panel">
            <mat-tab-group (selectedTabChange)="onTabChanged($event);">
                <mat-tab label="Upload">
                    <div class="right-panel p-4">
                        <custom-status-progress-bar (event)="dumpfun($event)"
                            [data]="this.pipoArrayListdata"></custom-status-progress-bar>
                        <div class="right-button-area">
                            <button class="btn btn-primary m-0 PopupOpen" style="width: 100px;"
                                popup-close="EDPMS_UPLOAD">Upload .xls</button>
                            <button class="btn btn-primary m-0" style="width: 100px;"
                                [disabled]="edpmsData.length!=0?false:true" (click)="onSubmit()">Submit</button>
                        </div>
                    </div>
                    <div class="table-panel">
                        <div class="col-12 p-0" #debitnotes>
                            <div class="row">
                                <div style="width:100%;height:690px" class="col-12 padding">
                                    <section class="pb-0 box-shadow">
                                        <div class="p-0 table-wrapper">
                                            <table class="table edpms-table mb-0">
                                                <thead>
                                                    <tr class="table-tr">
                                                        <th scope="col" class="col-td-th-3">#</th>
                                                        <th scope="col" class="col-td-th-2">Shipping Bill No.</th>
                                                        <th scope="col" class="col-td-th-2">Shipping Bill Date</th>
                                                        <th scope="col" class="col-td-th-3">AD Code</th>
                                                        <th scope="col" class="col-td-th-3">Port Code</th>
                                                        <th scope="col" class="col-td-th-2">EDPMS STATUS</th>
                                                        <th scope="col" class="col-td-th-3">AD Ref No.</th>
                                                        <th scope="col" class="col-td-th-3">SB Amount</th>
                                                        <th scope="col" class="col-td-th-2">SB Balance amount</th>
                                                        <th scope="col" class="col-td-th-2">System Status</th>
                                                        <th scope="col" class="col-td-th-2">Full Set Available</th>
                                                        <!-- <th scope="col" class="col-td-th-3">Action</th> -->
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="table-tr tableclick"
                                                        *ngFor="let row of edpmsData; let i = index"
                                                        (click)="clicktable(row?.sbdata)">
                                                        <th class="col-td-th-3">
                                                            {{(i+1)}}
                                                        </th>
                                                        <th class="col-td-th-2">
                                                            {{row?.sbNo}}
                                                        </th>
                                                        <td class="col-td-th-2">
                                                            {{row?.sbDate | date: 'dd/MM/yyyy'}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.adCode}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.portCode}}
                                                        </td>

                                                        <td class="col-td-th-2">
                                                            {{row?.edpmsStatus}}
                                                        </td>

                                                        <td class="col-td-th-3">
                                                            {{row?.adRefNo}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.sbdata?.fobValue}}
                                                        </td>
                                                        <td class="col-td-th-2">
                                                            {{row?.sbdata?.balanceAvai!="-1"?row?.sbdata?.balanceAvai:row?.sbdata?.fobValue}}
                                                        </td>
                                                        <td class="col-td-th-2">
                                                            {{row?.systemStatus}}
                                                        </td>
                                                        <td class="col-td-th-2">
                                                            {{row?.docAvailable==true?'Yes':'No'}}
                                                        </td>
                                                        <!-- <td class="col-td-th-3">
                                                        <div *ngFor="let act of row?.action"
                                                            [class.active]="act === 'Create Documents' || act === 'Upload Documents'"
                                                            (click)="actionEvent(act, row?.sbNo)">{{act}}</div>
                                                    </td> -->
                                                    </tr>

                                                </tbody>
                                            </table>
                                        </div>
                                    </section>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-tab>
                <mat-tab label="Previous Data">
                    <div *ngIf="this.FILTER_EDPMS_DATA.length!=0" class="right-panel p-2">
                        <custom-status-progress-bar (event)="dumpfun($event)"
                            [data]="this.pipoArrayListdata2"></custom-status-progress-bar>
                        <div class="right-button-area-1">
                            <button type="submit" [disabled]="this.SUBMIT_BUTTON"
                                class="btn btn-primary">Netoff/Setoff</button>
                            <button type="submit" [disabled]="this.SUBMIT_BUTTON" class="btn btn-primary">ETX</button>
                            <button type="submit" [disabled]="this.SUBMIT_BUTTON"
                                class="btn btn-primary">Writeoff</button>
                            <button type="submit" [disabled]="this.SUBMIT_BUTTON" routerLink="/home/direct-dispatch"
                                class="btn btn-primary">Submit D2B</button>
                            <app-ng-dropdown-custom style="margin-left:30px" placeHolderText="Search sb no."
                                width="170px" [items]="this.SB_NO_LIST" (modelChanges)="EDMPS_Search($event?.value)"
                                (keyEvent)="EDMPS_Search($event)" bindLabel="value" [multiple]="false"
                                #buyerNameSelection>
                            </app-ng-dropdown-custom>
                            <div class="pagination" style="height: 10px;" *ngIf="this.FILTER_EDPMS_DATA.length!=0">
                                <mat-paginator [length]="this.FILTER_EDPMS_DATA.length" [pageSize]="10"
                                    [pageSizeOptions]="this.pageSizeOptionsList" (page)="this.PAGINATION_EVENT($event)"
                                    aria-label="Select page">
                                </mat-paginator>
                            </div>
                        </div>
                    </div>
                    <div class="table-panel" *ngIf="this.FILTER_EDPMS_DATA.length!=0">
                        <div class="col-12 p-0" #debitnotes>
                            <div class="row">
                                <div style="width:100%;height:690px" class="col-12 padding">
                                    <section class="pb-0 box-shadow">
                                        <div class="p-0 table-wrapper">
                                            <table class="table edpms-table mb-0">
                                                <thead>
                                                    <tr class="table-tr">
                                                        <th scope="col" class="col-td-th-3">#</th>
                                                        <th scope="col" class="col-td-th-2">Shipping Bill No.</th>
                                                        <th scope="col" class="col-td-th-2">Shipping Bill Date</th>
                                                        <th scope="col" class="col-td-th-3">AD Code</th>
                                                        <th scope="col" class="col-td-th-3">Port Code</th>
                                                        <th scope="col" class="col-td-th-2">EDPMS STATUS</th>
                                                        <th scope="col" class="col-td-th-3">AD Ref No.</th>
                                                        <th scope="col" class="col-td-th-3">SB Amount</th>
                                                        <th scope="col" class="col-td-th-2">SB Balance amount</th>
                                                        <th scope="col" class="col-td-th-2">System Status</th>
                                                        <th scope="col" class="col-td-th-3">Doc Available</th>
                                                        <!-- <th scope="col" class="col-td-th-3">Action</th> -->
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="table-tr tableclick"
                                                        *ngFor="let row of this.FILTER_EDPMS_DATA; let i = index"
                                                        (click)="clicktable2(row?.sbdata)">
                                                        <th class="col-td-th-3">
                                                            {{(i+1)}}
                                                        </th>
                                                        <th class="col-td-th-2">
                                                            {{row?.sbNo}}
                                                        </th>
                                                        <td class="col-td-th-2">
                                                            {{row?.sbDate | date: 'dd/MM/yyyy'}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.adCode}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.portCode}}
                                                        </td>

                                                        <td class="col-td-th-2">
                                                            {{row?.edpmsStatus}}
                                                        </td>

                                                        <td class="col-td-th-3">
                                                            {{row?.adRefNo}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.sbdata?.fobValue}}
                                                        </td>
                                                        <td class="col-td-th-2">
                                                            {{row?.sbdata?.balanceAvai!="-1"?row?.sbdata?.balanceAvai:row?.sbdata?.fobValue}}
                                                        </td>
                                                        <td class="col-td-th-2">
                                                            {{row?.systemStatus}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.docAvailable==true?'Yes':'No'}}
                                                        </td>
                                                        <!-- <td class="col-td-th-3">
                                                            <div *ngFor="let act of row?.action"
                                                                [class.active]="act === 'Create Documents' || act === 'Upload Documents'"
                                                                (click)="actionEvent(act, row?.sbNo)">{{act}}</div>
                                                        </td> -->
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </section>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-tab>
                <mat-tab label="Entry Cleared">
                    <div *ngIf="this.FILTER_EDPMS_CLEARED_DATA.length!=0" class="right-panel p-2">
                        <custom-status-progress-bar (event)="dumpfun($event)"
                            [data]="this.pipoArrayListdata3"></custom-status-progress-bar>
                        <div class="right-button-area-2">
                            <app-ng-dropdown-custom placeHolderText="Search sb no." width="170px"
                                [items]="this.SB_NO_LIST2" (modelChanges)="EDMPS_Search2($event?.value)"
                                (keyEvent)="EDMPS_Search2($event)" bindLabel="value" [multiple]="false"
                                #buyerNameSelection>
                            </app-ng-dropdown-custom>
                            <div class="pagination" *ngIf="this.FILTER_EDPMS_CLEARED_DATA.length!=0">
                                <mat-paginator [length]="this.FILTER_EDPMS_CLEARED_DATA.length" [pageSize]="10"
                                    [pageSizeOptions]="this.pageSizeOptionsList2"
                                    (page)="this.PAGINATION_EVENT2($event)" aria-label="Select page">
                                </mat-paginator>
                            </div>
                        </div>
                    </div>
                    <div class="table-panel" *ngIf="this.FILTER_EDPMS_CLEARED_DATA.length!=0">
                        <div class="col-12 p-0" #debitnotes>
                            <div class="row">
                                <div style="width:100%;height:690px" class="col-12 padding">
                                    <section class="pb-0 box-shadow">
                                        <div class="p-0 table-wrapper">
                                            <table class="table edpms-table mb-0">
                                                <thead>
                                                    <tr class="table-tr">
                                                        <th scope="col" class="col-td-th-3">#</th>
                                                        <th scope="col" class="col-td-th-2">Shipping Bill No.</th>
                                                        <th scope="col" class="col-td-th-2">Shipping Bill Date</th>
                                                        <th scope="col" class="col-td-th-3">AD Code</th>
                                                        <th scope="col" class="col-td-th-3">Port Code</th>
                                                        <th scope="col" class="col-td-th-2">EDPMS STATUS</th>
                                                        <th scope="col" class="col-td-th-3">AD Ref No.</th>
                                                        <th scope="col" class="col-td-th-3">SB Amount</th>
                                                        <th scope="col" class="col-td-th-2">SB Balance amount</th>
                                                        <th scope="col" class="col-td-th-3">Status</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="table-tr tableclick"
                                                        *ngFor="let row of this.FILTER_EDPMS_CLEARED_DATA; let i = index"
                                                        (click)="clicktable3(row?.sbdata)">
                                                        <th class="col-td-th-3">
                                                            {{(i+1)}}
                                                        </th>
                                                        <th class="col-td-th-2">
                                                            {{row?.sbNo}}
                                                        </th>
                                                        <td class="col-td-th-2">
                                                            {{row?.sbDate | date: 'dd/MM/yyyy'}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.adCode}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.portCode}}
                                                        </td>

                                                        <td class="col-td-th-2">
                                                            {{row?.edpmsStatus}}
                                                        </td>

                                                        <td class="col-td-th-3">
                                                            {{row?.adRefNo}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.sbdata?.fobValue}}
                                                        </td>
                                                        <td class="col-td-th-2">
                                                            {{row?.sbdata?.balanceAvai!="-1"?row?.sbdata?.balanceAvai:row?.sbdata?.fobValue}}
                                                        </td>
                                                        <td class="col-td-th-3">
                                                            {{row?.cleared}}
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </section>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-tab>
            </mat-tab-group>
        </div>
    </main>
</div>

<app-custom-model [customstyle]="{'margin':'auto !important'}" class="p-2" height="95vh" id="pdf_view"
    [name]="'EDPMS Documents View'">
    <div class="col-12 p-2">
        <app-pdf-viewer *ngIf="this.SELECT_DOCUMENTS_VIEWS!=''" [downloadShow]="false"
            [name]="this.SELECT_DOCUMENTS_VIEWS?.text" [src]="this.SELECT_DOCUMENTS_VIEWS?.doc" width="100%"
            height="500px"></app-pdf-viewer>
    </div>
</app-custom-model>

<app-custom-model [customstyle]="{'margin':'auto !important'}" modalbodyheight="85vh" class="p-2" height="95vh"
    id="pdf_upload" [name]="'Upload EDPMS Documents'">
    <div class="col-12 p-2" *ngIf="this.SELECT_DOCUMENTS_UPLOAD!=''">
        <export-app-pipos *ngIf="this.SELECT_DOCUMENTS_UPLOAD?.text=='Pipo doc'"></export-app-pipos>
        <app-shipping-bill *ngIf="this.SELECT_DOCUMENTS_UPLOAD?.text=='Sb doc'"></app-shipping-bill>
        <export-airway-bl-copy *ngIf="this.SELECT_DOCUMENTS_UPLOAD?.text=='blCopy doc'"></export-airway-bl-copy>
        <export-commercial-invoices
            *ngIf="this.SELECT_DOCUMENTS_UPLOAD?.text=='commercial doc'"></export-commercial-invoices>
        <export-packing-list-invoices
            *ngIf="this.SELECT_DOCUMENTS_UPLOAD?.text=='packing doc'"></export-packing-list-invoices>
    </div>
</app-custom-model>

<upload-popup id="EDPMS_UPLOAD" url="documents/uploadFile3" UploadFilesNames="Upload EDPMS XSLS"
    acceptedFiles="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
    (event)="onUploadSuccess($event)"></upload-popup>