(self.webpackChunkdm_frontend=self.webpackChunkdm_frontend||[]).push([[592],{8038:(w,N,h)=>{"use strict";h.d(N,{G:()=>v});var y=h(1135),g=h(7489),S=h.n(g);class u{constructor(e){this._id=e._id?e._id:"",this.commodity=e.commodity?e.commodity:"",this.pi_poNo=e.pi_poNo?e.pi_poNo:"",this.currency=e.currency?e.currency:"",this.amount=e.amount?e.amount:"",this.incoterm=e.incoterm?e.incoterm:"",this.lastDayShipment=e.lastDayShipment?e.lastDayShipment:"",this.paymentTerm=e.paymentTerm?e.paymentTerm:[],this.pcRefNo=e.pcRefNo?e.pcRefNo:"",this.date=e.date?e.date:"",this.dueDate=e.dueDate?e.dueDate:"",this.location=e.location?e.location:"",this.buyerName=e.buyerName?e.buyerName:"",this.benneName=e.benneName?e.benneName:"",this.file=e.file?e.file:"",this.doc=e.doc?e.doc:"",this.document=e.document?e.document:"",this.purchasedate=e.purchasedate?e.purchasedate:"",this.userId=e.userId?e.userId:"",this.MasterServiceRef=e.MasterServiceRef?e.MasterServiceRef:[],this.airwayBlCopyRef=e.airwayBlCopyRef?e.airwayBlCopyRef:[],this.billOfExchangeRef=e.billOfExchangeRef?e.billOfExchangeRef:[],this.commercialRef=e.commercialRef?e.commercialRef:[],this.creditNoteRef=e.creditNoteRef?e.creditNoteRef:[],this.debitNoteRef=e.debitNoteRef?e.debitNoteRef:[],this.destructionRef=e.destructionRef?e.destructionRef:[],this.insuranceRef=e.insuranceRef?e.insuranceRef:[],this.lcRef=e.lcRef?e.lcRef:[],this.opinionReportRef=e.opinionReportRef?e.opinionReportRef:[],this.packingListRef=e.packingListRef?e.packingListRef:[],this.sbRef=e.sbRef?e.sbRef:[],this.tryPartyAgreementRef=e.tryPartyAgreementRef?e.tryPartyAgreementRef:[],this.irAdviceRef=e.irAdviceRef?e.irAdviceRef:[],this.ebrcRef=e.ebrcRef?e.ebrcRef:[],this.swiftRef=e.swiftRef?e.swiftRef:[],this.blcopyRefs=e.blcopyRefs?e.blcopyRefs:[]}}class m{constructor(e){this.paymentTerm=[],this.invoiceReduction=[],this.lcIssuance=[],this.initValues(e)}initValues(e){this._id=e._id?e._id:"",this.pi_poNo=e.pi_poNo?e.pi_poNo:"",this.date=e.date?e.date:"",this.buyerName=e.buyerName?e.buyerName:"",this.benneName=e.benneName?e.benneName:"",this.location=e.location?e.location:"",this.commodity=e.commodity?e.commodity:"",this.paymentTerm=e.paymentTerm?e.paymentTerm:"",this.irAdvice=e.irAdvice?e.irAdvice:"",this.invoiceReduction=e.invoiceReduction?e.invoiceReduction:"",this.lcIssuance=e.lcIssuance?e.lcIssuance:"",this.advanceOutward=e.advanceOutward?e.advanceOutward:"",this.swiftCopy=e.swiftCopy?e.swiftCopy:"",this.EBRC=e.EBRC?e.EBRC:"",this.blcopyref=e.blcopyref?e.blcopyref:"",this.tryPartyAgreement=e.tryPartyAgreement?e.tryPartyAgreement:"",this.debitNote=e.debitNote?e.debitNote:"",this.creditNote=e.creditNote?e.creditNote:"",this.lcCopy=e.lcCopy?e.lcCopy:"",this.opinionReport=e.opinionReport?e.opinionReport:"",this.airwayBlcopy=e.airwayBlcopy?e.airwayBlcopy:"",this.agreement=e.agreement?e.agreement:"",this.billOfExchange=e.billOfExchange?e.billOfExchange:"",this.commercial=e.commercial?e.commercial:"",this.destruction=e.destruction?e.destruction:"",this.otherDoc=e.otherDoc?e.otherDoc:"",this.packingList=e.packingList?e.packingList:"",this.sb=e.sb?e.sb:"",this.billUnder=e.billUnder?e.billUnder:"",this.doc=e.doc?e.doc:"",this.doc1=e.doc1?e.doc1:"",this.document=e.document?e.document:"",this.currency=e.currency?e.currency:"",this.incoterm=e.incoterm?e.incoterm:"",this.lastDayShipment=e.lastDayShipment?e.lastDayShipment:"",this.pcRefNo=e.pcRefNo?e.pcRefNo:"",this.dueDate=e.dueDate?e.dueDate:"",this.sbno=e.sbno?e.sbno:"",this.sbdate=e.sbdate?e.sbdate:"",this.region=e.region?e.region:"",this.fobValue=e.fobValue?e.fobValue:"",this.portCode=e.portCode?e.portCode:"",this.ttDate=e.ttDate?e.ttDate:"",this.ttUSD=e.ttUSD?e.ttUSD:"",this.recDate=e.recDate?e.recDate:"",this.recUSD=e.recUSD?e.recUSD:"",this.commission=e.commission?e.commission:"",this.conversionDate=e.conversionDate?e.conversionDate:"",this.conversionRate=e.conversionRate?e.conversionRate:"",this.convertedAmount=e.convertedAmount?e.convertedAmount:"",this.firxNumber=e.firxNumber?e.firxNumber:"",this.invoiceValueUSD=e.invoiceValueUSD?e.invoiceValueUSD:"",this.exchRate=e.exchRate?e.exchRate:"",this.amount=e.amount?e.amount:"",this.discountAllowed=e.discountAllowed?e.discountAllowed:"",this.damagesUSD=e.damagesUSD?e.damagesUSD:"",this.goodsShortageUSD=e.goodsShortageUSD?e.goodsShortageUSD:"",this.creditNoteStatus=e.creditNoteStatus?e.creditNoteStatus:"",this.egmNO=e.egmNO?e.egmNO:"",this.egmDate=e.egmDate?e.egmDate:"",this.statusOfRodtep=e.statusOfRodtep?e.statusOfRodtep:"",this.rodtepAmount=e.rodtepAmount?e.rodtepAmount:"",this.escriptNote=e.escriptNote?e.escriptNote:"",this.docSubmissionInBank=e.docSubmissionInBank?e.docSubmissionInBank:"",this.statusOfBankReco=e.statusOfBankReco?e.statusOfBankReco:"",this.firxNumberSettledAgainst=e.firxNumberSettledAgainst?e.firxNumberSettledAgainst:"",this.balanceIfAny=e.balanceIfAny?e.balanceIfAny:"",this.totaldecutions=this.discountAllowed+this.damagesUSD+this.goodsShortageUSD,this.finalAmounts=this.fobValue-this.discountAllowed-this.damagesUSD-this.goodsShortageUSD,this.billUnderDate=e.billUnderDate?e.billUnderDate:"",this.insuranceCopy=e.insuranceCopy?e.insuranceCopy:"",this.deliveryOrder=e.deliveryOrder?e.deliveryOrder:"",this.MasterServiceRef=e.MasterServiceRef?e.MasterServiceRef:[],this.airwayBlCopyRef=e.airwayBlCopyRef?e.airwayBlCopyRef:[],this.billOfExchangeRef=e.billOfExchangeRef?e.billOfExchangeRef:[],this.commercialRef=e.commercialRef?e.commercialRef:[],this.creditNoteRef=e.creditNoteRef?e.creditNoteRef:[],this.debitNoteRef=e.debitNoteRef?e.debitNoteRef:[],this.destructionRef=e.destructionRef?e.destructionRef:[],this.insuranceRef=e.insuranceRef?e.insuranceRef:[],this.lcRef=e.lcRef?e.lcRef:[],this.opinionReportRef=e.opinionReportRef?e.opinionReportRef:[],this.packingListRef=e.packingListRef?e.packingListRef:[],this.sbRef=e.sbRef?e.sbRef:[],this.tryPartyAgreementRef=e.tryPartyAgreementRef?e.tryPartyAgreementRef:[],this.irAdviceRef=e.irAdviceRef?e.irAdviceRef:[],this.ebrcRef=e.ebrcRef?e.ebrcRef:[],this.swiftRef=e.swiftRef?e.swiftRef:[],this.blcopyRefs=e.blcopyRefs?e.blcopyRefs:[]}computeForexSBPipoMerge(){let e=[];function s(o,n,r){for(let f in r)o[r[f]]=n[r[f]];return o}function i(o,n){let r=[];0===n.irRef.length&&r.push(o);for(let f in n.irRef){let c={...S().cloneDeep(o)},l=n.irRef[f];c.firxNumber=l.billNo,c.ttDate=l.date,c.ttUSD=l.amount,c.recDate=l.recievedDate,c.conversionRate=l.exchangeRate,c.commision=l.commision,c.conversionDate=l.conversionDate,c.commission=l.commision;let b=parseFloat(l.amount),A=l.commision.replace(/,/g,"");c.recUSD=b-A;let x=parseFloat(l.exchangeRate);c.convertedAmount=(c.recUSD*x).toFixed(2),r.push(c)}return r}this.sbRef&&0===this.sbRef.length&&e.push(this);for(let o in this.sbRef){let n={...S().cloneDeep(this)};delete n.sbRef,n.sbno=this.sbRef[o].sbno,n.sbdate=this.sbRef[o].sbdate,n.portCode=this.sbRef[o].portCode,n.region=this.sbRef[o].countryOfFinaldestination,n.fobValue=this.sbRef[o].fobValue,n=s(n,this.sbRef[o],["firxNumber","ttDate","ttUSD","recDate","conversionRate","commision","conversionDate","commission","recUSD","convertedAmount"]);let r=i(n,this.sbRef[o]);for(let f in r)e.push(new m(r[f]))}return e}}class R{constructor(e,s){this.pipolist=[],this.pipoModelList=[];for(let i of e)i.file==s&&"export"==s?(this.pipolist.push(new m(i)),this.pipoModelList.push(new u(i)),this.computeForexSBPipoMerge()):i.file==s&&"import"==s&&(this.pipolist.push(i),this.pipoModelList.push(new u(i)))}computeForexSBPipoMerge(){let e=[];for(let s in this.pipolist){let i=this.pipolist[s].computeForexSBPipoMerge();for(let o in i)e.push(i[o])}return this.pipolist=e,e}}var p=h(4650),D=h(6852);let v=(()=>{class t{constructor(s){this.documentService=s,this.pipolistSubsciber=new y.X([]),this.pipolistModelSubsciber=new y.X([]),this.pipoSingleSubsciber=new y.X(new m({})),this.getPipoList=i=>new Promise((o,n)=>{this.documentService.getPipo().subscribe(r=>{let f=new R(r.data,i);this.pipolistModelSubsciber.next(f.pipoModelList),this.pipolistSubsciber.next(f.pipolist),o(f)},r=>n(r))})}get pipo$(){return this.pipolistSubsciber.asObservable()}get pipoSingle$(){return this.pipoSingleSubsciber.asObservable()}get pipolistModel$(){return this.pipolistModelSubsciber.asObservable()}setPipoData(s,i){let o=new R(s,i);return this.pipolistSubsciber.next(o.pipolist),o}setSinglePipoData(s){this.pipoSingleSubsciber.next(new m(s))}getShippingBillById(s){let i=this.pipolistModelSubsciber.value;for(let o in i)if(i[o])for(let n in i[o].sbRef)if(i[o].sbRef[n]._id==s)return i[o].sbRef[n]}getShippingBills(s){let i=this.pipolistModelSubsciber.value;for(let o in i)if(i[o]._id==s)return i[o].sbRef}}return t.\u0275fac=function(s){return new(s||t)(p.LFG(D.Z))},t.\u0275prov=p.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4327:function(w,N){var g;void 0!==(g=function(){"use strict";function u(t,e,s){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){v(i.response,e,s)},i.onerror=function(){console.error("could not download file")},i.send()}function m(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function R(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var p="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,D=p.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=p.saveAs||("object"!=typeof window||window!==p?function(){}:"download"in HTMLAnchorElement.prototype&&!D?function(t,e,s){var i=p.URL||p.webkitURL,o=document.createElement("a");o.download=e=e||t.name||"download",o.rel="noopener","string"==typeof t?(o.href=t,o.origin===location.origin?R(o):m(o.href)?u(t,e,s):R(o,o.target="_blank")):(o.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(o.href)},4e4),setTimeout(function(){R(o)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,s){if(e=e||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function S(t,e){return typeof e>"u"?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,s),e);else if(m(t))u(t,e,s);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){R(i)})}}:function(t,e,s,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return u(t,e,s);var o="application/octet-stream"===t.type,n=/constructor/i.test(p.HTMLElement)||p.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||o&&n||D)&&typeof FileReader<"u"){var f=new FileReader;f.onloadend=function(){var b=f.result;b=r?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=b:location=b,i=null},f.readAsDataURL(t)}else{var c=p.URL||p.webkitURL,l=c.createObjectURL(t);i?i.location=l:location.href=l,i=null,setTimeout(function(){c.revokeObjectURL(l)},4e4)}});p.saveAs=v.saveAs=v,w.exports=v}.apply(N,[]))&&(w.exports=g)}}]);